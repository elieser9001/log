<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/assets/css/style.css?v=ea4d9e24f73514227d9d8e3f0665845df13d1249">
    <!-- start custom head snippets, customize with your own _includes/head-custom.html file -->

<!-- Setup theme-color -->
<!-- start theme color meta headers -->
<meta name="theme-color" content="#151515">
<meta name="msapplication-navbutton-color" content="#151515">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<!-- end theme color meta headers -->


<!-- Setup Google Analytics -->



<!-- You can set your favicon here -->
<!-- link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" -->

<!-- end custom head snippets -->


<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>cat log | Algunas cosas</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="cat log" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Algunas cosas" />
<meta property="og:description" content="Algunas cosas" />
<link rel="canonical" href="http://localhost:4000/" />
<meta property="og:url" content="http://localhost:4000/" />
<meta property="og:site_name" content="cat log" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="cat log" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebSite","description":"Algunas cosas","headline":"cat log","name":"cat log","url":"http://localhost:4000/"}</script>
<!-- End Jekyll SEO tag -->

  </head>

  <body>

    <header>
      <div class="container">
        <a id="a-title" href="/">
          <h1>cat log</h1>
        </a>
        <h2>Algunas cosas</h2>

        <section id="downloads">
          
          <a href="https://github.com/elieser9001/log" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <p><img src="https://raw.githubusercontent.com/elieser9001/assets/main/antenna.png" alt="windows_icon" style="float: left; margin-right: 10px;" /></p>
<h1 id="netsuites">NetSuites</h1>

<p>En la universidad en 1999 hice un sistema usando Sockets para administrar remotamente todas las estaciones de Windows NT en los laboratorios de informÃ¡tica para llevar el control del tiempo de uso de cada una de las estaciones (en su tiempo era como un sistema que hoy en dÃ­a es usado para administrar los cibercafes) entre las funciones que le integre estaba la de vigilar por medio de las Windows Api (Winapi) cualquier palabra prohibida como por ejemplo: pornografÃ­a, apuestas y demÃ¡s palabras claves restringidas en el uso acadÃ©mico dentro de los tÃ­tulos de las ventanas abiertas y proceder a cerrarlas y notificar al supervisor del suceso acontecido.</p>

<p>Use Visual Basic 5 y luego lo actualice a la versiÃ³n 6 con Sockets usando protocolos TCP y UDP para el broadcast que me permitÃ­a agregar las direcciones IPâ€™s de todas las estaciones que tenÃ­an instalado mi sistema servidor y asÃ­ se muestran automÃ¡ticamente en el sistema cliente, por lo cual termine desarrollando 2 sistemas, un cliente y un servidor.</p>

<p>Las fotos a continuaciÃ³n son tomadas de una copia hecha hace mÃ¡s de 2 dÃ©cadas a la tesis original.</p>

<center>
<img src="https://github.com/elieser9001/assets/blob/main/netsuite1.jpeg?raw=true" alt="netsuite" style="width: 400px" />
</center>

<center>
<img src="https://github.com/elieser9001/assets/blob/main/netsuite2.jpeg?raw=true" alt="netsuite" style="width: 400px" />
</center>

<center>
<img src="https://github.com/elieser9001/assets/blob/main/netsuite3.jpeg?raw=true" alt="netsuite" style="width: 400px" />
</center>

<hr />

<p><img src="https://github.com/elieser9001/assets/blob/main/netjoe1.png?raw=true" alt="netjoe" style="float: left; margin-right: 10px;" /></p>

<h1 id="netjoe">NetJoe</h1>

<p>A comienzos de la primera dÃ©cada del 2000, hice en Delphi 6, un troyano llamado NetJoe, me inspirÃ© en el Netbus. Ver como funcionaba el Netbus en la Ã©poca de los 90â€™s para mÃ­ fue ver magia pura, por eso decidÃ­ que algÃºn dÃ­a iba a hacer uno propio y el resultado fue el NetJoe, en las noches solÃ­a escanear el puerto 12345 del rango de mi IP y encontrar computadoras que tenÃ­an el servidor de Netbus activo y asÃ­ poder entonces comunicarme con esos usuarios para hablar con ellos, porque yo inferÃ­a que si lo tenÃ­an activo es porque le interesaba tanto la programaciÃ³n como a mÃ­ y poder contarle que estaba haciendo uno con mÃ¡s funciones que el Netbus, luego los agregaba a mi Msn Messenger y desde ahÃ­ hablabamos mejor. LleguÃ© a vender por Mercadolibre alrededor de 3 copias, donde lo usaba para darle soporte a los que me lo compraban.</p>

<p>Recuerdo que tambiÃ©n hice una versiÃ³n de NetJoe para usar conexiÃ³n reversa.</p>

<p>Las funciones que le hice en cada Tab:</p>

<p><strong>Informacion:</strong></p>
<ul>
  <li>Nombre del host remoto.</li>
  <li>Ruta de la carpeta del Sistema remoto.</li>
  <li>Usuario logeado remoto.</li>
</ul>

<p><strong>Pass:</strong></p>
<ul>
  <li>RecopilaciÃ³n (Dump) de todos los passwords de conexiÃ³n dial-up para Internet.</li>
</ul>

<p><strong>Ventanas:</strong></p>
<ul>
  <li>Lista de todas las ventanas visibles y no visibles desplegadas en el sistema, con opciÃ³n a cerrar ventana, ocultar ventana, mostrar ventana, deshabilitar y actualizar lista de ventanas.</li>
</ul>

<p><strong>Webcam:</strong></p>
<ul>
  <li>Inicializar/Detener la CÃ¡mara Web Remota y mostrar capturas mÃºltiples, con la opciÃ³n de guardar automÃ¡ticamente en local.</li>
</ul>

<p><strong>Pantalla:</strong></p>
<ul>
  <li>Capturar la pantalla remota y mostrar capturas mÃºltiples, con la opciÃ³n de guardar automÃ¡ticamente en local.</li>
</ul>

<p><strong>Registro:</strong></p>
<ul>
  <li>Manipular el registro de Windows, con la opciÃ³n de crear, modificar, borrar cadenas y valores dentro de cualquier Key en la mÃ¡quina remota.</li>
</ul>

<p><strong>Archivos:</strong></p>
<ul>
  <li>Navegar dentro de la estructura de archivo de Windows de la mÃ¡quina remota, poder ejecutar, crear, borrar, subir, descargar archivos remotamente.</li>
</ul>

<p><strong>Teclas:</strong></p>
<ul>
  <li>Capturar en vivo todas las teclas presionadas en la mÃ¡quina remota.</li>
</ul>

<p><strong>L.A.N:</strong></p>
<ul>
  <li>Hacer un broadcast dentro de la red de area local para buscar servidores de NetJoe desplegados y en ejecuciÃ³n.</li>
</ul>

<center>
<img src="https://github.com/elieser9001/assets/blob/main/netjoe4.png?raw=true" alt="netsuite" style="width: 400px" />
</center>

<center>
<img src="https://github.com/elieser9001/assets/blob/main/netjoe7.png?raw=true" alt="netsuite" style="width: 400px" />
</center>

<center>
<img src="https://github.com/elieser9001/assets/blob/main/netjoe6.png?raw=true" alt="netsuite" style="width: 400px" />
</center>
<hr />

<p><img src="https://github.com/elieser9001/assets/blob/main/captura_desde_linux_el_exe.png?raw=true" alt="cph" style="float: left; margin-right: 10px;" /></p>

<h1 id="cph-ciberpuesto-hack">C.P.H. CiberPuesto Hack</h1>

<p>Este sistema lo desarrollÃ© para poder controlar cualquier computadora remotamente dentro de la red local de un cibercafe que estuviese instalado y funcionando el ciberpuesto 4.0
y tambiÃ©n extraer la contraseÃ±a de administrador del sistema para poder desbloquear o hacer labores administrativas del ciberpuesto, lo llame C.P.H. (Ciberpuesto Hack)</p>

<p>Lo hice como prueba de concepto de las fallas que me di cuenta de que el Ciberpuesto y Cibercontrol tenian, la primera vez que vi ese sistema funcionando, me di cuenta la similitud que tenÃ­a con el sistema que habÃ­a hecho para mi tesis y me dio curiosidad y en cuanto llegue a mi casa descargue una versiÃ³n de prueba.</p>

<p>Desensamble el ejecutable y modifique el puerto TCP con el que el Ciberpuesto abrÃ­a para esperar conexiÃ³n y entonces hice un pequeÃ±o ejecutable que abrÃ­a el puerto correcto e interceptaba todas las peticiones que venÃ­an desde el Cibercontrol (Cliente) y luego se las pasaba al ciberpuesto (un man in the middle) y asÃ­ pude hacer un log de todos los comandos para poder hacer el sistema C.P.H.</p>

<p>En la parte de la contrasena me fijÃ© que el ciberpuesto en la ruta de c:\windows\system32\ alojaba una base de datos de access la cual estaba bloqueada debido a que el ciberpuesto al iniciar la bloqueaba y no dejaba copiar, por lo que para que me mostrara la contraseÃ±a tenÃ­a que cerrar en menos de 1 segundo el ciberpuesto enviÃ¡ndole por medio una funciÃ³n de Winapi32 que si mal no recuerdo era ExitProcess pasÃ¡ndole el handle de la ventana, y entonces copiar en una ubicaciÃ³n temporal la base de datos y asÃ­ extraer y mostrar la contraseÃ±a.</p>

<p><strong>Funciones Remotas</strong></p>
<ul>
  <li>Apagar.</li>
  <li>Reniciar.</li>
  <li>Cerrar SesiÃ³n.</li>
  <li>Finalizar CiberPuesto (desbloquear computadora).</li>
  <li>Subir / Bajar Volumen.</li>
  <li>Enviar Mensaje y mostrar Mensaje.</li>
  <li>Mostrar la contraseÃ±a de administraciÃ³n del CiberPuesto.</li>
</ul>

<p>Entre los anÃ¡lisis que le hice al Ciberpuesto desensamblando y usando el Windbg para tomar los datos que le enviaba al ciberpuesto me di cuenta de que podÃ­a hacer un buffer overflow que desencadenaria una ejecuciÃ³n remota de cualquier payload que hiciese, entonces hice en lenguaje C dos payloads uno para los Windows con service pack 1 y 2 y desde entonces podÃ­a tener mÃ¡s control de cualquier computadora del ciber con ciberpuesto 4.0, podÃ­a compartir en una carpeta local y entonces ejecutar cualquier ejecutable que colocase en esa carpeta ejecutarlo en la mÃ¡quina remota, como por ejemplo el ejecutable del servidor del netjoe para hacer mÃ¡s fÃ¡cil la ejecuciÃ³n remota de Ã³rdenes. ( a estos los llamÃ© xcp1.exe para service pack 1 y xcp2.exe para service pack 2)</p>

<hr />

<p><img src="https://github.com/elieser9001/assets/blob/main/guerrapandilla1.jpg?raw=true" alt="cph" style="float: left; margin-right: 10px; width: 400px" /></p>

<h1 id="script-guerra-de-pandillas">Script Guerra de Pandillas</h1>

<p>Es un script en Python que hice en el 2008 para que jugase guerra de pandillas mientras yo me iba a dormir.</p>

<p>Guerra de pandillas era un juego HTML dentro de Facebook, que simulaba una economÃ­a de pandillas por medio de buscar contrincantes y entablar una riÃ±a que se podÃ­a ganar o no dependiendo varios factores. Con el script que hice analizaba varios factores, entre ellos las propiedades que poseÃ­an los posibles contrincantes y entonces por medio del anÃ¡lisis decidir si pelear o no.</p>

<p>El script es del aÃ±o 2008, cuando estaba comenzando a aprender Python. ğŸ˜†</p>

<p>```python:
import sys
import httphack
import threading
import sys
import socket
import string
import os
import time</p>

<p>cont_lista_peleas = 0</p>

<p>TIEMPO_REFRESCAR = 30.0
EN_PARA_HACER_MISION = 16
NUM_MISION = 8
MIN_HP = 40 #mi hp minimo para pelear</p>

<p>class c_mi:
  nivel = 0
  puntos = â€˜â€™
  hp = 0
  hp_max = 0
  sta = 0
  sta_max = 0
  efectivo = 0
  banco = 0</p>

<p>mi = c_mi()</p>

<p>class c_pandillero:
  id = â€˜â€™
  sig = â€˜â€™
  nombre = â€˜â€™
  nivel = 0
  apodo = â€˜â€™
  esquina = 0
  tienda = 0
  cibercafe = 0
  gimnasio = 0
  bar = 0
  restaurante = 0
  discoteca = 0
  prostibulo = 0
  centro_comercial = 0
  hotel = 0
  casino = 0</p>

<p>cookie_bot = â€˜â€™</p>

<p>def exit_client():
  raise SystemExit</p>

<p>def extraer(fullstring,strinicio,strfinal):
  _posName = fullstring.find(strinicio)</p>

<p>if (_posName &gt;= 0):
    _posName += len(strinicio)
    _posFinal = fullstring.find(strfinal,_posName)
    _resultado = fullstring[_posName:_posFinal]
  else:
    _resultado = â€˜â€™</p>

<p>return _resultado</p>

<p>def dato_nivel(datos):
  resultado = extraer(datos,â€™â€œprofilebox_itemâ€&gt;Nivel: â€˜,â€™&lt;/div&gt;â€™)</p>

<p>return resultado</p>

<p>def dato_hp(datos):
  resultado = extraer(datos,â€™&lt;div&gt;HP: â€˜,â€™&lt;/div&gt;â€™)</p>

<p>return resultado</p>

<p>def dato_en(datos):
  resultado = extraer(datos,â€™&lt;div class="profilebox_item"&gt;EN: â€˜,â€™&lt;/div&gt;â€™)</p>

<p>return resultado</p>

<p>def dato_en(datos):
  resultado = extraer(datos,â€™&lt;div class="profilebox_item"&gt;EN: â€˜,â€™&lt;/div&gt;â€™)</p>

<p>return resultado</p>

<p>def dato_sta(datos):
  resultado = extraer(datos,â€™&lt;div class="profilebox_item"&gt;STA: â€˜,â€™&lt;/div&gt;â€™)</p>

<p>return resultado</p>

<p>def dato_banco(datos):
  resultado = extraer(datos,â€™( Mi cuenta del banco: <span class="green">$â€™,â€™</span>,â€™)</p>

<p>return resultado</p>

<p>def dato_efectivo(datos):
  resultado = extraer(datos,â€™inero: <span class="green">â€™,â€™</span>&lt;/div&gt;â€™)</p>

<p>return resultado</p>

<p>def server_paquete(datos):<br />
  pos_linea = datos.find(chr(13))
  pos_espacio = datos.find(â€˜ â€˜)</p>

<p>tipo = datos[0:pos_espacio]</p>

<p>cgi = extraer(datos,â€™ â€˜,â€™ â€˜)
  servidor = extraer(datos,â€™Host: â€˜,chr(13))
  cookie = extraer(datos,â€™Cookie: â€˜,chr(13))</p>

<p>return ({â€˜tipoâ€™:tipo,â€™cgiâ€™:cgi,â€™servidorâ€™:servidor,â€™cookieâ€™:cookie})</p>

<p>class letsrock(threading.Thread):
  def run(self):<br />
    #socket â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
    sck_servidor = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    sck_servidor.bind((â€˜localhostâ€™, 8080))
    sck_servidor.listen(5)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>conn, addr = sck_servidor.accept()
sck_servidor.setblocking(0)
    
_html = ''
  
puerto = 80

sck_cliente = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    

while(True):
  _datos_rcv = str(conn.recv(1024))      

  if not _datos_rcv:
    break
    conn.close()
  
  
  info_paquete = server_paquete(_datos_rcv)
  
  tipo = info_paquete['tipo']
  servidor = info_paquete['servidor']
  cgi = info_paquete['cgi']
  cookie = info_paquete['cookie']
  
  parametros = ""   

  datos = httphack.peticionhttp(servidor,cgi,tipo,parametros,cookie=cookie,debug_mode=True,encode_cgi=False)['data']
      
  _html += _datos_rcv
</code></pre></div></div>

<p>def tomar_cookie(conn):
  global cookie_bot
  datos = â€˜â€™</p>

<p>while(1):
    _datos_rcv = str(conn.recv(1024))
    datos += _datos_rcv</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if (len(_datos_rcv) &lt;= 0) or (datos.find("__qcb=")&gt;=0):
  conn.close()
  break
</code></pre></div></div>

<p>if (len(datos) &gt; 0):
    info_paquete = server_paquete(datos)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tipo = info_paquete['tipo']
servidor = info_paquete['servidor']
cgi = info_paquete['cgi']
cookie = info_paquete['cookie']

if (servidor == 'apps.facebook.com') and (len(cookie) &gt; 0) :
  cookie_bot = cookie

  return True
else:
  cookie_bot = ''
  print "[-]-Error al inicializar (Intente nuevamente)"
  print datos
  return False   else:
return False
</code></pre></div></div>

<p>def actualizar_datos(datos):
  banco = dato_banco(datos)
  efectivo = dato_efectivo(datos)
  nivel = dato_nivel(datos)
  hp = dato_hp(datos)
  en = dato_en(datos)
  sta = dato_sta(datos)</p>

<p>efectivo = string.replace(efectivo,â€™$â€™,â€™â€™)
  efectivo = string.replace(efectivo,â€™,â€™,â€™â€™)</p>

<p>pos_barra_hp = hp.find(â€˜/â€™)
  pos_barra_en = en.find(â€˜/â€™)
  pos_barra_sta = sta.find(â€˜/â€™)<br />
  pos_barra_nivel = nivel.find(â€˜ â€˜)</p>

<p>print â€œEFECTIVO â€œ + efectivo
  print â€œPRUEBA DE NIVEL: â€œ + nivel[0:pos_barra_nivel]
  print â€œPuntos: â€œ + extraer(nivel,â€™(â€˜,â€™)â€™)
  print â€œEN maximo: â€œ + en[pos_barra_en+1:len(en)]
  print â€œSTA: â€œ + sta</p>

<p>mi.banco = banco
  mi.efectivo = int(efectivo)
  mi.nivel = int(nivel[0:pos_barra_nivel])
  mi.puntos = extraer(nivel,â€™(â€˜,â€™)â€™)
  mi.hp = int(hp[0:pos_barra_hp])
  mi.en = int(en[0:pos_barra_en])
  mi.en_max = int(en[pos_barra_en+1:len(en)])
  mi.sta = int(sta[0:pos_barra_sta])
  mi.sta_max = int(sta[pos_barra_sta+1:len(sta)])</p>

<p>def ack(cookie_inicial=â€™â€™):
  global cookie_bot
  try:
    if len(cookie_inicial)&gt;0:  <br />
      cookie = cookie_inicial
      servidor = â€œapps.facebook.comâ€
      puerto = 80
      tipo = â€œPOSTâ€
      cgi = â€œ/ajax/chat/buddy_list.phpâ€
      parametros = â€˜user=702519843&amp;popped_out=false&amp;&amp;force_render=false&amp;buddy_list=1&amp;post_form_id=7f96c82dab148e91ee567685a827f1e7â€™</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  paquete = 'POST /ajax/chat/buddy_list.php HTTP/1.1' + chr(13) + chr(10)
  paquete += 'Host: apps.facebook.com' + chr(13) + chr(10)
  paquete += 'User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; es-ES; rv:1.9.0.3) Gecko/2008092417 Firefox/3.0.3' + chr(13) + chr(10)
  paquete += 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' + chr(13) + chr(10)
  paquete += 'Accept-Language: es-es,es;q=0.8,en-us;q=0.5,en;q=0.3' + chr(13) + chr(10)
  paquete += 'Accept-Encoding: deflate' + chr(13) + chr(10)
  paquete += 'Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7' + chr(13) + chr(10)
  paquete += 'Keep-Alive: 300' + chr(13) + chr(10)
  paquete += 'Proxy-Connection: keep-alive' + chr(13) + chr(10)
  paquete += 'X-SVN-Rev: 130297' + chr(13) + chr(10)
  paquete += 'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' + chr(13) + chr(10)
  paquete += 'Cookie: ' + cookie_inicial + chr(13) + chr(10)      
  paquete += 'Pragma: no-cache' + chr(13) + chr(10)
  paquete += 'Cache-Control: no-cache' + chr(13) + chr(10)
  paquete += 'Content-Length: ' + str(len(parametros)) + chr(13) + chr(10) + chr(13) + chr(10)
  
  paquete += parametros
  
  sck_cliente = socket.socket(socket.AF_INET, socket.SOCK_STREAM)    
  sck_cliente.connect((servidor, puerto))
  sck_cliente.send(paquete)
  
  datos = ''
  
  _datos_rcv = str(sck_cliente.recv(1024))
  datos += _datos_rcv
  
  error_numero = extraer(datos,'"error":',',"')
  
  if error_numero == '0':
    error_info = 'Todo Bien'
    nuevo_xs = extraer(datos,"xs=",';')
    nuevo_time = extraer(datos,'"time":','000,')        
    
    cookie_time = extraer(cookie_bot,"time%22%3A","%2C%22ch")
    cookie_xs = extraer(cookie_bot,"xs=",';')        
    
    if len(nuevo_xs) &gt; 0:
      cookie_bot =  string.replace(cookie_bot,cookie_xs,nuevo_xs)        
    
    if len(cookie_time) &gt; 0:
      cookie_bot = string.replace(cookie_bot,cookie_time,nuevo_time)
  
    tipo = "GET"
    cgi = "/guerra-de-pandillas/bank.php"
    cookie = cookie_bot
    parametros = ""
    
    datos = httphack.peticionhttp(servidor,cgi,tipo,parametros,cookie=cookie,debug_mode=True,encode_cgi=False)['data']

    #print datos
    
    if len(datos) &gt; 0:
      actualizar_datos(datos)
      
      print "--------------------------ACK------------------------------------"
      print "    Nivel: " + str(mi.nivel) + " (" + mi.puntos + ")"
      print "       HP: " + str(mi.hp)
      print "       EN: " + str(mi.en)
      print "      STA: " + str(mi.sta)
      print " Efectivo: " + str(mi.efectivo)
      print "    Banco: " + str(mi.banco)
      print ""
      print " Ultima actualizacion: -[" + time.strftime("%H:%M:%S %p - %d/%m/%Y") + "]-"
      print "--------------------------------------------------------------"         
      
      evaluar(cookie)        
  else:
    print "ACK"
    error_info = extraer(datos,'"errorSummary":"','","')
    print "[-]-&gt; Error numero: " + error_numero
    print "[-]-&gt; " + error_info      
else:
  if len(cookie_bot) &gt; 0 :
    pass
  else:
    print "[-]-Error cookie en blanco"       except:
pass
</code></pre></div></div>

<p>def doit():
  ack(cookie_bot)
  tmr_ping()</p>

<p>def tmr_ping():
	tmrEnv = threading.Timer(TIEMPO_REFRESCAR, doit)
	tmrEnv.start()</p>

<p>def hacer_mision(num_mision,cookie):
  servidor = â€œapps.facebook.comâ€
  puerto = 80
  tipo = â€œPOSTâ€
  cgi = â€œ/guerra-de-pandillas/job.phpâ€
  parametros = â€˜fb_sig_locale=es_LA&amp;fb_sig_in_new_facebook=1&amp;fb_sig_time=1227319787.6404&amp;fb_sig_added=1&amp;fb_sig_profile_update_time=1225403288&amp;fb_sig_expires=1227406187&amp;fb_sig_user=702519843&amp;fb_sig_session_key=d358bf8467a0f8f3dbf81c97-702519843&amp;fb_sig_api_key=32d28c1bc20d6febfd2ea928c9f5745e&amp;fb_sig=c53a74e068386e9a1f5766f31387cab5&amp;id=â€™ + str(num_mision) + â€˜&amp;sig=3f867f5ac351d486ce3c117bd10b48a68610dd3câ€™
  datos = httphack.peticionhttp(servidor,cgi,tipo,parametros,cookie=cookie,debug_mode=True,encode_cgi=False)[â€˜dataâ€™]</p>

<p>#print datos</p>

<p>if len(datos) &gt; 0:
    #gpd = gpdatos(datos)
    actualizar_datos(datos)
    # os.system(â€œclsâ€)
    print â€œâ€”â€”â€”â€”â€”â€”â€”â€”â€”Hacermisionâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“â€
    print â€œ    Nivel: â€œ + str(mi.nivel)
    print â€œ       HP: â€œ + str(mi.hp)
    print â€œ       EN: â€œ + str(mi.en)
    print â€œ      STA: â€œ + str(mi.sta)
    print â€œ Efectivo: â€œ + str(mi.efectivo)
    print â€œ    Banco: â€œ + str(mi.banco)
    print â€œâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“â€
  else:
    print â€œHACER MISIONâ€
    error_info = extraer(datos,â€™â€œerrorSummaryâ€:â€â€™,â€™â€,â€â€™)
    print â€œ[-]-&gt; Error numero: â€œ + error_numero
    print â€œ[-]-&gt; â€œ + error_info</p>

<p>def depositar(monto,cookie):
  servidor = â€œapps.facebook.comâ€
  puerto = 80
  tipo = â€œPOSTâ€
  cgi = â€œ/guerra-de-pandillas/bank.phpâ€
  #cookie = cookie_bot
  parametros = â€˜fb_sig_locale=es_LA&amp;fb_sig_in_new_facebook=1&amp;fb_sig_time=1226121856.5241&amp;fb_sig_added=1&amp;fb_sig_profile_update_time=1225403288&amp;fb_sig_expires=1226208256&amp;fb_sig_user=702519843&amp;fb_sig_session_key=e43ac5bf49316bec4835d147-702519843&amp;fb_sig_api_key=32d28c1bc20d6febfd2ea928c9f5745e&amp;fb_sig=66c423b3a0380090b688e89ded4a44db&amp;amount=â€™ + str(monto) + â€˜&amp;deposit=Depositarâ€™</p>

<p>datos = httphack.peticionhttp(servidor,cgi,tipo,parametros,cookie=cookie,debug_mode=True,encode_cgi=False)[â€˜dataâ€™]</p>

<p>#print datos</p>

<p>if len(datos) &gt; 0:
    actualizar_datos(datos)
    # os.system(â€œclsâ€)
    print â€œâ€”â€”â€”â€”â€”â€”â€”â€”â€“depositarâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€
    print â€œ    Nivel: â€œ + str(mi.nivel)
    print â€œ       HP: â€œ + str(mi.hp)
    print â€œ       EN: â€œ + str(mi.en)
    print â€œ      STA: â€œ + str(mi.sta)
    print â€œ Efectivo: â€œ + str(mi.efectivo)
    print â€œ    Banco: â€œ + str(mi.banco)
    print â€œâ€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“â€
  else:
    print â€œDepositarâ€
    error_info = extraer(datos,â€™â€œerrorSummaryâ€:â€â€™,â€™â€,â€â€™)
    print â€œ[-]-&gt; Error numero: â€œ + error_numero
    print â€œ[-]-&gt; â€œ + error_info</p>

<p>def evaluar(cookie):
  #$159,900
  #22/22</p>

<p>#Nota: Colocar como constante global</p>

<p>while(1):
    if (mi.hp &gt;= MIN_HP):
      resultado = buscar_pelea(cookie)
      #return ({â€˜pandillerosâ€™:pandilleros,â€™parametros_peleaâ€™:parametros_pelea})
      pandilleros = resultado[â€˜pandillerosâ€™]
      parametros_pelea = resultado[â€˜parametros_peleaâ€™]</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  for pandillero in pandilleros:
    if (mi.hp &gt;= MIN_HP) and (mi.sta &gt;= 1):
      if ((int(pandillero.nivel) &lt;= mi.nivel) and (pandillero.casino&gt;0) and (pandillero.hotel&gt;0) and (pandillero.estado &lt;&gt; "Grave")):
        print "Elegido " + pandillero.nombre + " para pelear!"
        pelear(pandillero,parametros_pelea,cookie) #QUE ACTUALICE MI HP POR LO MENOS QUE SEA GLOBAL
        print "Pelea con " + pandillero.nombre + " finalizada"
    else:
      break
else:
  break
</code></pre></div></div>

<p>int_efectivo = mi.efectivo
  int_en = mi.en</p>

<p>if int_efectivo &gt;= 100:
    depositar(int_efectivo,cookie)</p>

<p>if int_en &gt;= EN_PARA_HACER_MISION:
    hacer_mision(NUM_MISION,cookie)</p>

<p>def armar_parametros_pelea(datos):
  resultado = â€˜fb_sig_locale=es_LA&amp;fb_sig_in_new_facebook=1â€™
  temp_param = []
  temp_param.append(â€˜fb_sig_timeâ€™)
  temp_param.append(â€˜fb_sig_addedâ€™)
  temp_param.append(â€˜fb_sig_profile_update_timeâ€™)
  temp_param.append(â€˜fb_sig_expiresâ€™)
  temp_param.append(â€˜fb_sig_userâ€™)
  temp_param.append(â€˜fb_sig_session_keyâ€™)
  temp_param.append(â€˜fb_sig_api_keyâ€™)
  temp_param.append(â€˜fb_sigâ€™)</p>

<p>for param in temp_param: 
    #temp_param = â€˜&amp;â€™ + param
    resultado += â€˜&amp;â€™ + param + â€˜=â€™ + extraer(datos,â€™name=â€â€™ + param + â€˜â€ value=â€â€™,â€™â€ /&gt;â€™)</p>

<p>resultado += â€˜&amp;action=fight_single&amp;id=IDPANDILLERO&amp;sig=â€™</p>

<p>#print â€œEN ARMARâ€ + resultado
  #exit_client()</p>

<p>return resultado</p>

<p>def prueba_data(archivo):
  fileHandle = open (archivo)
  resultado = fileHandle.read()
  fileHandle.close() 
  return resultado</p>

<p>def pedir_lista_peleas(cookie):
  global cont_lista_peleas</p>

<p>servidor = â€œapps.facebook.comâ€
  puerto = 80
  tipo = â€œGETâ€
  #cgi = â€˜/ajax/ct.php?app_id=19100272286&amp;action_type=3&amp;post_form_id=4621c09af5c8d918cee82aeed4a39ba5&amp;position=3&amp;0.6336457102957316â€™</p>

<p>#cgi = â€˜/guerra-de-pandillas/fight.phpâ€™</p>

<p>if (cont_lista_peleas &lt; 1001):
    cont_lista_peleas += 5
  else:
    cont_lista_peleas = 5</p>

<p>cgi = â€˜/guerra-de-pandillas/fight.php?b=â€™ + str(cont_lista_peleas)
  #http://apps.facebook.com/guerra-de-pandillas/fight.php?b=5
  #cookie = cookie_bot
  parametros = â€˜â€™</p>

<p>datos = httphack.peticionhttp(servidor,cgi,tipo,parametros,cookie=cookie,debug_mode=True,encode_cgi=False)[â€˜dataâ€™]</p>

<p>#print datos</p>

<p>if len(datos) &gt; 0:  <br />
    return datos
  else:
    print â€œpedir listaâ€
    error_numero = extraer(datos,â€™â€œerrorâ€:â€™,â€™,â€â€™)
    error_info = extraer(datos,â€™â€œerrorSummaryâ€:â€â€™,â€™â€,â€â€™)
    print â€œ[-]-&gt; Error numero: â€œ + error_numero
    print â€œ[-]-&gt; â€œ + error_info
    exit_client()</p>

<p>def pelear(pand,parametros_pelea,cookie):
  #print â€œ<strong>**</strong>***EN PELEAR ID: â€œ + id<br />
  servidor = â€œapps.facebook.comâ€
  puerto = 80
  tipo = â€œPOSTâ€
  cgi = â€˜/guerra-de-pandillas/details.phpâ€™
  cookie += â€˜; made_write_conn=1226268812â€™</p>

<p>parametros = parametros_pelea.replace(â€˜IDPANDILLEROâ€™,str(pand.id))
  parametros += pand.sig</p>

<p>#print â€œPARAMETROS DE PELEA: â€œ + parametros
  #exit_client()</p>

<p>datos = httphack.peticionhttp(servidor,cgi,tipo,parametros,cookie=cookie,debug_mode=True,encode_cgi=False)[â€˜dataâ€™]</p>

<p>if len(datos) &gt; 0:
    actualizar_datos(datos)
  else:
    print â€œError en pelear()â€
    error_info = extraer(datos,â€™â€œerrorSummaryâ€:â€â€™,â€™â€,â€â€™)
    print â€œ[-]-&gt; Error numero: â€œ + error_numero
    print â€œ[-]-&gt; â€œ + error_info
    exit_client()</p>

<p>def buscar_pelea(cookie):
  datos = pedir_lista_peleas(cookie)
  parametros_pelea = armar_parametros_pelea(datos)</p>

<p>#print â€œPARAMETROS LISTA EN BUSCAR PELEA: â€œ + parametros_lista
  #exit_client()</p>

<p>marcador = â€˜&lt;div class="mod_info"&gt;â€™
  pos_primero = datos.find(marcador)</p>

<p>datos = datos[pos_primero:len(datos)]
  #print datos</p>

<p>marcador2 = â€˜&lt;div class="mod_profile_pic"&gt;â€™
  tmp = datos.split(marcador2)</p>

<p>pandilleros = []</p>

<p>print â€œâ€”â€”â€”â€”â€”â€”â€”â€”â€“Buscando Peleaâ€¦â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€
  print â€œâ€
  print â€œâ€</p>

<p>#i = 1
  for i in range(5):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dato_pandillero = tmp[i]
id = extraer(dato_pandillero,'&lt;a name="','"')
sig = extraer(dato_pandillero,'&amp;#039;,&amp;#039;','&amp;#039;);}')
nombre = extraer(dato_pandillero,';return true;"&gt;','&lt;/a&gt;&lt;br /&gt;')    
nivel = extraer(dato_pandillero,'Nivel: &lt;span class="green"&gt;','&lt;/span&gt;')    
apodo = extraer(dato_pandillero,'Apodo: &lt;span class="blue"&gt;','&lt;/span&gt;')

if dato_pandillero.find('Estado: &lt;span class="green"&gt;') &gt; 0:
  estado = "Normal"
elif dato_pandillero.find('Estado: &lt;span class="yellow"&gt;') &gt; 0:
  estado = "Herido"
elif dato_pandillero.find('Estado: &lt;span class="red"&gt;') &gt; 0:
  estado = "Grave"
else:
  estado = "Desconocido"


pand = c_pandillero()
    
pand.id = id
pand.sig = sig
pand.nombre = nombre
pand.nivel = int(nivel)
pand.apodo = apodo
pand.estado = estado

pand_resultado = propiedades_pandillero(pand,cookie)

#Comentar
#"""
print "==================================================="
print "     ID: " + str(pand_resultado.id)
print "    SIG: " + str(pand_resultado.sig)
print " Nombre: " + str(pand_resultado.nombre)
print "  Nivel: " + str(pand_resultado.nivel)
print "  Apodo: " + str(pand_resultado.apodo)
print " Estado: " + str(pand_resultado.estado)    
print "Esquina: " + str(pand_resultado.esquina)
print "  Hotel: " + str(pand_resultado.hotel)
print " Casino: " + str(pand_resultado.casino)
#print "==================================================="
#"""

pandilleros.append(pand_resultado)
</code></pre></div></div>

<p>return ({â€˜pandillerosâ€™:pandilleros,â€™parametros_peleaâ€™:parametros_pelea})</p>

<p>def desglosar_propiedades_pandillero(datos,pand):<br />
  marca_esquina = â€˜â€œblueâ€&gt;Esquina (â€˜<br />
  marca_tienda = â€˜â€œblueâ€&gt;Tienda (â€˜
  marca_cibercafe = â€˜â€œblueâ€&gt;Ciber-cafâ€™
  marca_gimnasio =  â€˜â€œblueâ€&gt;Gimnasio (â€˜
  marca_bar = â€˜â€œblueâ€&gt;Bar (â€˜
  marca_restaurante = â€˜â€œblueâ€&gt;Restaurante (â€˜
  marca_discoteca = â€˜â€œblueâ€&gt;Discoteca (â€˜
  marca_prostibulo = â€˜â€œblueâ€&gt;Prostâ€™
  marca_centro_comercial = â€˜â€œblueâ€&gt;Centro comercial (â€˜
  marca_hotel = â€˜â€œblueâ€&gt;Hotel (â€˜
  marca_casino = â€˜â€œblueâ€&gt;Casino (â€˜</p>

<p>if datos.find(marca_esquina) &gt; 0:<br />
    esquina = extraer(datos,marca_esquina,â€™)â€™)
  else:
    esquina = 0</p>

<p>if datos.find(marca_tienda) &gt; 0:<br />
    tienda = extraer(datos,marca_tienda,â€™)â€™)
  else:
    tienda = 0</p>

<p>if datos.find(marca_cibercafe) &gt; 0:<br />
    cibercafe = extraer(datos,marca_cibercafe,â€™&lt;/span&gt;â€™)
    cibercafe = extraer(cibercafe,â€™(â€˜,â€™)â€™)
  else:
    cibercafe = 0</p>

<p>if datos.find(marca_gimnasio) &gt; 0:<br />
    gimnasio =  extraer(datos,marca_gimnasio,â€™)â€™)
  else:
    gimnasio = 0</p>

<p>if datos.find(marca_bar) &gt; 0:<br />
    bar = extraer(datos,marca_bar,â€™)â€™)
  else:
    bar = 0</p>

<p>if datos.find(marca_restaurante) &gt; 0:<br />
    restaurante = extraer(datos,marca_restaurante,â€™)â€™)
  else:
    restaurante = 0</p>

<p>if datos.find(marca_discoteca) &gt; 0:<br />
    discoteca = extraer(datos,marca_discoteca,â€™)â€™)
  else:
    discoteca = 0</p>

<p>if datos.find(marca_prostibulo) &gt; 0:<br />
    prostibulo = extraer(datos,marca_prostibulo,â€™&lt;/span&gt;â€™)
    prostibulo = extraer(prostibulo,â€™(â€˜,â€™)â€™)
  else:
    prostibulo = 0</p>

<p>if datos.find(marca_centro_comercial) &gt; 0:<br />
    centro_comercial = extraer(datos,marca_centro_comercial,â€™)â€™)
  else:
    centro_comercial = 0</p>

<p>if datos.find(marca_hotel) &gt; 0:<br />
    hotel = extraer(datos,marca_hotel,â€™)â€™)
  else:
    hotel = 0</p>

<p>if datos.find(marca_casino) &gt; 0:<br />
    casino = extraer(datos,marca_casino,â€™)â€™)
  else:
    casino = 0</p>

<p>pand.esquina = esquina
  pand.tienda = tienda
  pand.cibercafe = cibercafe
  pand.gimnasio = gimnasio
  pand.bar = bar
  pand.restaurante = restaurante
  pand.discoteca = discoteca
  pand.prostibulo = prostibulo
  pand.centro_comercial = centro_comercial
  pand.hotel = hotel
  pand.casino = casino</p>

<p>return pand</p>

<p>def propiedades_pandillero(pand,cookie):
  id_pandillero = pand.id</p>

<p>servidor = â€œapps.facebook.comâ€
  puerto = 80
  tipo = â€œGETâ€
  cgi = â€œ/guerra-de-pandillas/details.php?id=â€ + id_pandillero
  #cookie = cookie_bot
  parametros = â€˜â€™</p>

<p>datos = httphack.peticionhttp(servidor,cgi,tipo,parametros,cookie=cookie,debug_mode=True,encode_cgi=False)[â€˜dataâ€™]</p>

<p>#print datos</p>

<p>if len(datos) &gt; 0:  <br />
    pand_resultado = desglosar_propiedades_pandillero(datos,pand)
  else:
    print â€œPropiedades Pandilleroâ€
    error_info = extraer(datos,â€™â€œerrorSummaryâ€:â€â€™,â€™â€,â€â€™)
    print â€œ[-]-&gt; Error numero: â€œ + error_numero
    print â€œ[-]-&gt; â€œ + error_info <br />
    exit_client()</p>

<p>return pand_resultado</p>

<p>def main():
  global cookie_bot</p>

<p>os.system(â€œclsâ€)</p>

<p>sck_servidor = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</p>

<p>sck_servidor.bind((socket.gethostname(), 8080))</p>

<p>sck_servidor.listen(5)</p>

<p>while (1):
    conn, addr = sck_servidor.accept()<br />
    if tomar_cookie(conn) == True:
      sck_servidor.close()
      break</p>

<p>ack(cookie_bot)
  tmr_ping()</p>

<p>if <strong>name</strong> == â€˜<strong>main</strong>â€™:
  main()</p>


      </section>
    </div>
  </body>
</html>
